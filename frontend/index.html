<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="AI-powered healthcare symptom assessment and risk analysis platform" />
  <meta name="theme-color" content="#0891b2" />
  <title>AI Health - Intelligent Healthcare Platform</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

  <!-- ========== NAVBAR ========== -->
  <nav class="navbar">
    <div class="navbar-inner">
      <a href="index.html" class="nav-logo">
        <!-- Activity icon -->
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
        TEAM IGRIS
      </a>

      <ul class="nav-links" id="navLinks">
        <li><a href="index.html" class="active">Home</a></li>
        <li><a href="dashboard.html">Dashboard</a></li>
        <li><a href="about.html">About Us</a></li>
      </ul>
      

      <button class="nav-hamburger" id="hamburger" aria-label="Toggle menu">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
      </button>
    </div>
  </nav>

  <main>

    <!-- ========== HERO ========== -->
    <section class="hero">
      <div class="hero-bg">
        <div class="hero-overlay"></div>
      </div>

      <div class="hero-content">
        <div class="hero-badge anim-fade-up">
          <!-- Shield icon -->
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
          The future is healthier when prevention comes first.
        </div>

        <h1 class="anim-fade-up anim-delay-1">
          Health is Wealth.<span>Smart healthcare, at your fingertips</span>
        </h1>

        <p class="anim-fade-up anim-delay-2">
          Get instant AI-driven symptom assessments, risk analysis, and personalized health recommendations.
          Built for modern healthcare professionals and patients alike.
        </p>

        <div class="anim-fade-up anim-delay-3">
          <a href="#assessment" class="btn btn-primary">
            CHECK YOUR HEALTH STATUS
            <!-- Arrow icon -->
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
          </a>
        </div>
      </div>
    </section>

    <!-- ========== SYMPTOM FORM ========== -->
    <section class="form-section" id="assessment">
      <div class="card anim-fade-up">
        <div class="card-header">
          <h2>Symptom Assessment</h2>
          <p>Enter your details and select your symptoms for an AI-powered risk assessment.</p>
        </div>
        <div class="card-body">
          <form id="symptomForm" class="flex-gap" novalidate>

            <!-- Age & Days -->
            <div class="form-grid">
              <div class="form-group">
                <label for="age">Age</label>
                <input type="number" id="age" placeholder="3 - 90" min="3" max="90" required />
                <span class="error-text" id="ageError"></span>
              </div>
              <div class="form-group">
                <label for="days">Days with Symptoms</label>
                <input type="number" id="days" placeholder="1 - 10" min="1" max="10" required />
                <span class="error-text" id="daysError"></span>
              </div>
            </div>

            <!-- Symptom Toggles -->
            <div>
              <p class="symptom-label">Symptoms</p>
              <div class="symptom-grid">
                <button type="button" class="symptom-btn" data-symptom="fever">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z"/></svg>
                  Fever
                </button>
                <button type="button" class="symptom-btn" data-symptom="cough">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2"/><path d="M9.6 4.6A2 2 0 1 1 11 8H2"/><path d="M12.6 19.4A2 2 0 1 0 14 16H2"/></svg>
                  Cough
                </button>
                <button type="button" class="symptom-btn" data-symptom="breathlessness">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4.8 2.3A.3.3 0 1 0 5 2H4a2 2 0 0 0-2 2v5a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6V4a2 2 0 0 0-2-2h-1a.2.2 0 1 0 .3.3"/><path d="M8 15v1a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6v-4"/><circle cx="20" cy="10" r="2"/></svg>
                  Breathlessness
                </button>
                <button type="button" class="symptom-btn" data-symptom="chestPain">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>
                  Chest Pain
                </button>
              </div>
              <!-- Medical History Toggles -->
               <br></div>
              <div>
                <p class="symptom-label">Previous Medical History</p>
                <div class="symptom-grid">
                  
                  <button type="button" class="symptom-btn" data-history="asthma">
                    Asthma
                  </button>

                  <button type="button" class="symptom-btn" data-history="diabetes">
                    Diabetes
                  </button>

                  <button type="button" class="symptom-btn" data-history="heart_disease">
                    Heart Disease
                  </button>

                </div>
              </div>
            </div>

            <!-- Submit -->
            <button type="submit" class="btn btn-primary btn-block" id="submitBtn">
              Check My Health
            </button>
          </form>
        </div>
      </div>
    </section>

    <!-- ========== RESULT ========== -->
    <section class="result-section" id="resultSection">
      <div class="card anim-fade-up" id="resultCard">
        <div class="result-header">
          <h2>Assessment Result</h2>
          <span class="risk-badge" id="riskBadge"></span>
        </div>
        <div class="result-body">
          <div>
            <div class="confidence-info">
              <span>Confidence Level</span>
              <span id="confidenceValue">0%</span>
            </div>
            <div class="confidence-bar-track">
              <div class="confidence-bar-fill" id="confidenceBar"></div>
            </div>
          </div>
          <div>
            <p class="result-rec-label">Recommendations</p>
            <p class="result-rec-text" id="recText">
              <span id="typedText"></span><span class="typing-cursor"></span>
            </p>
          </div>
        </div>
      </div>
    </section>

  </main>

  <!-- ========== FOOTER ========== -->
  <footer class="footer">
    &copy; 2026 TEAM IGRIS. All rights reserved.This is a demo.
  </footer>

  <!-- ========== SCRIPT ========== -->
  <script>
    // Mobile nav toggle
    document.getElementById('hamburger').addEventListener('click', function () {
      document.getElementById('navLinks').classList.toggle('open');
    });

    // Symptom toggle buttons
    document.querySelectorAll('.symptom-btn').forEach(function (btn) {
      btn.addEventListener('click', function () {
        btn.classList.toggle('selected');
      });
    });

    // Form submission
    document.getElementById('symptomForm').addEventListener('submit', function (e) {
      e.preventDefault();

      // Validate
      var ageVal = parseInt(document.getElementById('age').value);
      var daysVal = parseInt(document.getElementById('days').value);
      var valid = true;

      document.getElementById('ageError').textContent = '';
      document.getElementById('daysError').textContent = '';
      document.getElementById('age').classList.remove('error');
      document.getElementById('days').classList.remove('error');

      if (isNaN(ageVal) || ageVal < 3 || ageVal > 90) {
        document.getElementById('ageError').textContent = 'Age must be between 3 and 90';
        document.getElementById('age').classList.add('error');
        valid = false;
      }
      if (isNaN(daysVal) || daysVal < 1 || daysVal > 10) {
        document.getElementById('daysError').textContent = 'Days must be between 1 and 10';
        document.getElementById('days').classList.add('error');
        valid = false;
      }
      if (!valid) return;

      // Loading state
      var submitBtn = document.getElementById('submitBtn');
      submitBtn.classList.add('loading');
      submitBtn.innerHTML = '<span class="spinner"></span> Analyzing Symptoms...';

      // Gather symptoms
      // Collect symptom values
      var fever = document.querySelector('[data-symptom="fever"]').classList.contains('selected') ? 1 : 0;
      var cough = document.querySelector('[data-symptom="cough"]').classList.contains('selected') ? 1 : 0;
      var breathlessness = document.querySelector('[data-symptom="breathlessness"]').classList.contains('selected') ? 1 : 0;
      var chestPain = document.querySelector('[data-symptom="chestPain"]').classList.contains('selected') ? 1 : 0;

      // Collect medical history
      var asthma = document.querySelector('[data-history="asthma"]').classList.contains('selected') ? 1 : 0;
      var diabetes = document.querySelector('[data-history="diabetes"]').classList.contains('selected') ? 1 : 0;
      var heartDisease = document.querySelector('[data-history="heart_disease"]').classList.contains('selected') ? 1 : 0;

      // Prepare request body
      var requestData = {
        age: ageVal,
        fever: fever,
        cough: cough,
        breathlessness: breathlessness,
        chest_pain: chestPain,
        days: daysVal,
        asthma: asthma,
        diabetes: diabetes,
        heart_disease: heartDisease
      };

      // Call backend API
      fetch("https://ai-health-triage-50eo.onrender.com/triage", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(requestData)
      })
      .then(response => response.json())
      .then(data => {

        submitBtn.classList.remove('loading');
        submitBtn.innerHTML = 'Check My Health';

        if (data.error) {
          alert("Error: " + data.error);
          return;
        }

        var recommendationText = "";

        if (data.recommendation_text) {
          recommendationText = data.recommendation_text.trim();
        } 
        else if (data.recommendations) {
          recommendationText = data.recommendations.join("\n");
        }
        else {
          recommendationText = "No recommendation available.";
        }
        // Split lines
        var lines = recommendationText.split("\n");

        var formattedHTML = "";

        lines.forEach(function(line) {

        line = line.trim();

        if (line.startsWith("-") || line.startsWith("•")) {
          formattedHTML += "<div class='rec-item'>• " + line.replace(/^[-•]\s*/, "") + "</div>";
        } 
        else if (line.toLowerCase().startsWith("when to see")) {
          formattedHTML += "<div class='rec-warning'>" + line + "</div>";
        }

      });


      showResult(data.risk, data.confidence, formattedHTML);



      })
      .catch(error => {
        submitBtn.classList.remove('loading');
        submitBtn.innerHTML = 'Check My Health';
        alert("Backend not responding. Make sure Flask server is running.");
      });


      
    });

    function showResult(risk, confidence, recommendation) {
      var section = document.getElementById('resultSection');
      var card = document.getElementById('resultCard');
      var badge = document.getElementById('riskBadge');
      var bar = document.getElementById('confidenceBar');
      var confVal = document.getElementById('confidenceValue');

      // Reset
      section.classList.add('visible');
      card.className = 'card anim-fade-up';
      badge.className = 'risk-badge';

      // Set risk
      badge.textContent = risk + ' Risk';
      if (risk === 'Low') {
        badge.classList.add('risk-low');
        card.classList.add('card-result-low');
      } else if (risk === 'Medium') {
        badge.classList.add('risk-medium');
        card.classList.add('card-result-medium');
      } else {
        badge.classList.add('risk-high');
        card.classList.add('card-result-high');
      }

      // Animate confidence bar
      confVal.textContent = confidence + '%';
      bar.style.width = '0';
      setTimeout(function () {
        bar.style.width = confidence + '%';
      }, 100);

      // Typing effect
      // Typing effect
      var typedEl = document.getElementById('typedText');
      var cursor = document.querySelector('.typing-cursor');

      typedEl.innerHTML = "";
      cursor.style.display = "inline-block"; // show cursor at start

      var lines = recommendation.split("</div>");
      var index = 0;

      function typeNextLine() {
        if (index < lines.length) {
          if (lines[index].trim() !== "") {
            typedEl.innerHTML += lines[index] + "</div>";
          }
          index++;
          setTimeout(typeNextLine, 400);
        } else {
          cursor.style.display = "none"; // hide cursor after typing done
        }
      }

      typeNextLine();



      // Scroll into view
      section.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }
  </script>
</body>
</html>
